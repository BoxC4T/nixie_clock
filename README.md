This code is kinda shit 
if you have any idea just submit a pull request
